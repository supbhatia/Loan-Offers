select top(5) * from NYC;
select top(5) * from cen;
------------------------------------------------------------------------------------------------------------------------------
--Renaming a table name--
EXEC sp_rename 'nyccensus1', 'nyccensus'
--Renaming a column name--
EXEC sp_rename 'census.census', 'cbg', 'COLUMN';
--see which tables are in your schema
select * from information_schema.tables;
-------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------Pulling NYC data from USA census- -----------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
SELECT * 
INTO NYCcensus
FROM
    cen
 where tract in (
26901	,18100	,31703	,9800	,28400	,8400	,2100	,3200	,26500	,77500	,9200	,46000	,68300	,19400	,19900	,60300	,
12500	,36700	,13700	,30600	,49100	,11700	,8000	,3800	,4100	,57800	,5800	,17011	,29400	,1600	,3900	,59600	,
13400	,7100	,11800	,43200	,1501	,22500	,15300	,5000	,22703	,2900	,3002	,21700	,57100	,62000	,6700	,42200	,
10200	,600	,52500	,46201	,40000	,72600	,63200	,15100	,22200	,55400	,24800	,23703	,50400	,53200	,120500	,12200	,
5900	,69800	,11900	,3001	,30500	,115200	,42100	,5600	,21303	,16900	,900	,1800	,23501  ,27100  ,21100	,1502	,
6300	,25302	,48400	,47800	,52300	,36901	,38600	,8100	,15500	,42300	,20100	,17300	,87100	,4800	,48200	,7500	,
63700	,16600	,26100	,41100	,16500	,11500	,39500	,67700	,86900	,12902	,2000	,5700	,74300	,34800	,134100	,51602	,
12100	,55300	,18401	,9100	,40700	,27702	,6500	,6100	,300	,27700	,71304,86500,8601,11201	,10900	,26602	,4300	,
14602	,8500	,62100	,147900	,35200	,24500	,10800	,136700	,29700	,19100	,29600	,24000	,6900	,11300	,36300	,5200	,
19500	,13300	,10500	,48100	,22900	,8700	,23300	,40900	,44300	,1900	,9500	,54900	,3100	,55700	,31704	,18300	,
7300	,16100	,20700	,10300	,53300	,15700	,29300	,88901	,800	,19700	,700	,33900	,90800	,157901	,89200	,39800	,
11401	,68000	,117601	,3300	,7700	,22700	,16700	,10602	,33700	,66200	,36400	,78600	,5902	,18000	,80900	,71303	,
34500	,6800	,50300	,73700	,6200	,4500	,29102	,25500	,26300	,8300	,13200	,11202	,10400	,19800	,76901	,40500	,
35900	,4001	,51700	,14604	,15801	,60800	,39000	,2202	,5300	,27900	,116700	,7000	,112800	,10100	,14200	,1300	,
115700	,12000	,30000	,138501	,20000	,118400	,9600	,9000	,101000	,7400	,134700	,15802	,23800	,38900	,144700	,10000	,
17100	,35100	,7600	,12700	,28300	,4600	,20500	,79200	,58200	,39200	,50500	,51300	,32600	,37900	,13900	,91900	,
2602	,28100	,85300	,13600	,36200	,42700	,20300	,62800	,146700	,36900	,49302	,27300	,124100	,73100	,94202	,33401	,
17800	,84900	,6400	,150702	,29103	,27402	,8200	,117100	,29500	,2500	,7800	,15200	,44601	,31701	,8800	,29104	,
86800	,127700	,1402	,49300	,49600	,27600	,502	,13500	,2800	,83800	,94203	,45102	,47100	,43900	,147100	,15400	,
107000	,41401	,29100	,43100	,28501	,86000	,1700	,84500	,20800	,29800	,29000	,25900	,14500	,13800	,21900	,7900	,
23900	,7200	,56900	,12701	,93800	,3400	,155102	,9601	,59401	,64102	,86400	,3700	,23700	,69500	,22000	,22600	,
12600	,6600	,4900	,16300	,49500	,11100	,4000	,39902	,14202	,79702	,150701	,28700	,152902	,18600	,19300	,18101	,
18501	,13100	,87200	,25100	,42500	,21200	,50800	,8900	,117800	,56300	,4200	,51600	,9300	,23802	,61004	,42600	,
13000	,10601	,28500	,122000	,80301	,47400	,11000	,18200	,3602	,15603	,16800	,9900	,114400	,59000	,152200	,38100	,
31500	,58500	,66501	,105804	,116300	,22300	,14000	,107201	,24600	,2700	,25300	,6502	,18102	,14300	,33600	,42800	,
39300	,23200	,37700	,28200	,27500	,14900	,82400	,1100	,55100	,37500	,18702	,4700	,9400	,35000	,14100	,119100	,
71100	,24100	,25200	,24300	,21400	,10701	,65000	,38302	,117000	,5400	,77000	,146300	,46500	,11402	,3601	,83600	,
00100	,43500	,19600	,44000	,27800	,30400	,48600	,28900	,32800	,56600	,36001	,16000	,55000	,17000	,39900	,79802	,
109900	,20801	,23100	,43600	,57900	,12901	,20901	,8600	,48500	,112300	,59100	,14601	,
155101	,501	,50600	,10600	,46202	,96600	,40200	,56100	,22301	,52600	,18400	,2702	,12800	,9700	,23000	,51200	,
30300	,41400	,17402	,5002	,17005	,5502	,104700	,57700	,78800	,63301	,43702	,117400	,69300	,79900	,13203	,65703	,
51400	,44602	,17200	,17500	,84000	,28800	,5100	,61301	,21600	,28000	,21502	,38700	,1000	,101001	,30902	,12400	,
11203	,58300	,11200	,81600	,15601	,94201	,18502	,55900	,21800	,54500	,21500	,32300	,44400	,31702	,3500	,
95400	,50801	,53400	,53800	,49900	,94500	,14802	,97204	,37300	,43700	,101700	,44100	,2600	,112600	,26900	,5501	,
77400	,18800	,119600	,14400	,49400	,17400	,86200	,22302	,97400	,92900	,41800	,89600	,39100	,80000	,22404	,2200	,
31400	,130100	,16002	,96000	,41900	,301	,50803	,25600	,23400	,44900	,14700	,46100	,18701	,38500	,52000	,122300	,
45400	,95000	,2601	,93400	,23502	,86600	,42900	,157903	,109800	,92400	,93000	,41700	,118100	,14800	,85900	,44700	,
85800	,88400	,39700	,85500	,99200	,45800	,60600	,24900	,67600	,50000	,50202	,30900	,14606	,25700	,91000	,61600	,
40502	,123700	,16400	,25400	,26800	,26700	,88000	,96800	,51900	,133300	,23704	,87000	,40300	,71600	,83700	,22102	,
161700	,68800	,65400	,58400	,53000	,75701	,24200	,50900	,33100	,122702	,126500	,82600	,
54200	,64500	,116800	,22800	,56800	,83000	,26902	,56500	,12101	,58900	,1400	,54700	,49700	,21601	,80400	,33800	,
56400	,15900	,46200	,1401	,35500	,32500	,67900	,77907	,2201	,90700	,45300	,24700	,27301	,18500	,49000	,36000	,
23301	,40400	,62200	,51002	,20900	,79000	,38301	,25800	,58100	,6000	,85700	,18900	,40304	,40303	,90000	,20701	,
26701	,91800	,36502	,47500	,57400	,200	,98700	,37000	,61602	,17702	,30302	,119000	,17900	,35300	,119300	,94600	,
16901	,39901	,116600	,34700	,72000	,50700	,20200	,32400	,35700	,22403	,55500	,43300	,12804	,1500	,40302	,500	,
40800	,52800	,117201	,61003	,17700	,11502	,37504	,26600	,23500	,62900	,70201	,18700	,36002	,36100	,28600	,12900	,
76902	,74200	,34000	,4401	,89000	,67000	,63800	,44200	,48900	,36501	,77902	,117500	,24301	,122701	,44302	,19702	,
400	,91601	,112000	,110400	,63900	,109700	,101200	,81800	,47000	,33000	,26200	,15602	,76000	,95600	,49200	,44901	,
14801	,48000	,115000	,54300	,5601	,37402	,20101	,60000	,22101	,22100	,21000	,42400	,119800	,51100	,43000	,14607	,
32700	,27200	,118900	,25301	,92200	,84600	,14402	,33500	,12102	,80200	,162100	,31900	,24502	,71306	,157902	,87800	,
133900	,99704	,77906	,31300	,88200	,32900	,21002	,22002	,20400	,33402	,137700	,39400	,82000	,87600	,20600	,30100	,
12801	,23600	,67100	,33202	,12601	,85600	,157101	,16200	,46900	,24400	,46800	,26000	,27706	,22400	,99100	,13204	,
35800	,59402	,15800	,90600	,202	,18302	,26400	,13302	,52700	,34900	,40100	,12806	,23801	,117602	,57600	,44500	,
62500	,102900	,92500	,59500	,40600	,31000	,35400	,57500	,16001	,21302	,111600	,43400	,51001	,67400	,64200	,46600	,
34400	,29200	,12301	,14401	,14605	,53500	,17701	,45500	,6501	,129104	,29900	,93402	,21602	,36600	,81400	,70202	,
14702	,49301	,114600	,79601	,4400	,11400	,57000	,99801	,
33400	,115600	,31200	,45000	,100600	,38000	,19000	,15001	,73800	,11600	,53100	,47200	,32000	,55200	,79701	,47300	,
65600	,73600	,32100	,17902	,17010	,20601	,79602	,77200	,51601	,58000	,15002	,88800	,96400	,47900	,37800	,3600	,
69601	,63000	,21001	,51500	,18901	,98100	,46300	,21301	,57300	,82800	,48300	,99701	,29302	,4002	,
31100	,30200	,38300	,51800	,21300	,30903	,103900	,152901	,33300	,58800	,30301	,80800	,5500	,79400	,118800	,71305	,
72100	,44902	,40702	,40501	,22702	,41500	,42000	,9602	,71701	,25000	,113400	,63500	,15000	,83400	,36800	,72900	,
44301	,26601	,112900	,120700	,41300	,74600	,92000	,103300	,31700	,113300	,5602	,120800	,
118500	,6202	,145102	,22701	,15600	,141700	,43800	,17901	,37400	,121100	,53900	,41200	,33201	,100802	,93401	,60100	,
108500	,142900	,18301	,74800	,83200	,30700	,1200	,77904	,145900	,69000	,47700	,17600	,2400	,34300	,52100	,115500	,
143500	,12602	,94401	,50100	,75000	,36902	,89800	,126700	,48800	,100800	,34200	,3000	,71702	,45101	,21703	,2002	,
77905	,99802	,8603	,98400	,54000	,102800	,72200	,76800	,27400	,59800	,115900	,120000	,23702	,36500	,102200	,35602	,
120100	,42902	,24401	,30800	,114201	,99000	,37100	,47600	,17401	,40701	,49800	,46700	,107800	,82200	,79801	,69602	,
89400	,74000	,112400	,70700	,67200	,116400	,56000	,70900	,38400	,72800	,22902	,35600	,20102	,201	,22401	,59300	,
103400	,44600	,39600	,118202	,38200	,45600	,37600	,65200	,145101	,58600	,99703	,51000	,81000	,72400	,
24501	,14701	,78000	,62600	,52900	,70000	,66400	,64400	,87401	,41402	,118600	,90200	,93200	,61900	,66701	,99705	,
14201	,113900	,64600	,73000	,91600	,37200	,30904	,20804	,103202	,20502	,103201	,12300	,52400	,21501	,5001	,61800	,
80600	,68700	,2001	,140300	,53700	,157102	,97203	,65702	,114100	,27000	,121500	,65800	,113000	,129103	,99800	,84602	,
88600	,19200	,62300	,64800	,69702	,59900	,66300	,98600	,96200	,38800	,24402	,56700	,63302	,66600	,119400	,44800	,
34100	,59200	,95800	,53401	,150200	,37401	,78400	,58700	,118201	,138502	,93900	,2901	,140902	,86100	,116100	,84800	,
97300	,125700	,129102	,73400	,18402	,128300	,112200	,22901	,2701	,94402	,124700	,61302	,77600	,
119900	,101800	,69701	,54800	,139900	,94700	,148300	,46400	,70300	,144100	,65900	,72300)	
;
-------------------------------------------------------------------------------------------------------------------------------
--uploaded cen (census) and NYC clean data NYC from cen, made NYCcensus where there are only NYC tract number------------------
-------------------------------------------------------------------------------------------------------------------------------

ALTER TABLE NYCcensus DROP 'dummy_cell';
sp_columns nyccensus
select * from NYC order by census_tract;

select census_tract,count(*) from nyc n group by census_tract

select	tract	,sum(White)	White	,sum(African)	African	,sum(American_Indian)	American_Indian	,sum(Asian)	Asian	,
sum(Hawaiian)	Hawaiian	,sum(Other_race)	Other_race	,sum(INCOME_Less_than_10_000)	INCOME_Less_than_10_000	,
sum(INCOME_10_000_to_14_999)	INCOME_10_000_to_14_999	,sum(INCOME_15_000_to_19_999)	INCOME_15_000_to_19_999	,
sum(INCOME_20_000_to_24_999)	INCOME_20_000_to_24_999	,sum(INCOME_25_000_to_29_999)	INCOME_25_000_to_29_999	,
sum(INCOME_30_000_to_34_999)	INCOME_30_000_to_34_999	,sum(INCOME_35_000_to_39_999)	INCOME_35_000_to_39_999	,
sum(INCOME_40_000_to_44_999)	INCOME_40_000_to_44_999	,sum(INCOME_45_000_to_49_999)	INCOME_45_000_to_49_999	,
sum(INCOME_50_000_to_59_999)	INCOME_50_000_to_59_999	,sum(INCOME_60_000_to_74_999)	INCOME_60_000_to_74_999	,
sum(INCOME_75_000_to_99_999)	INCOME_75_000_to_99_999	,sum(INCOME_100_000_to_124_999)	INCOME_100_000_to_124_999	,
sum(INCOME_125_000_to_149_999)	INCOME_125_000_to_149_999	,sum(INCOME_150_000_to_199_999)	INCOME_150_000_to_199_999	,
sum(INCOME_200_000_or_more)	INCOME_200_000_or_more	,sum(Male_Total)	Male_Total	,sum(Female_Total)	Female_Total	
from nyccensus c group by tract order by tract;
-------------------------------------------------------------------------------------------------------------------------
--NYC
/*DBA, BORO, ZIPCODE, CUISINE_DESCRIPTION, CRITICAL_FLAG, GRADE, Census_Tract*/
--NYCcensus
/*tract,White,African,	American_Indian,	Asian,	Hawaiian,	Other_race,	
INCOME_Less_than_10_000,	INCOME_10_000_to_14_999,	INCOME_15_000_to_19_999,	INCOME_20_000_to_24_999,
INCOME_25_000_to_29_999,	INCOME_30_000_to_34_999,	INCOME_35_000_to_39_999,	INCOME_40_000_to_44_999,
INCOME_45_000_to_49_999,	INCOME_50_000_to_59_999,	INCOME_60_000_to_74_999,	INCOME_75_000_to_99_999,
INCOME_100_000_to_124_999,	INCOME_125_000_to_149_999,	INCOME_150_000_to_199_999,	INCOME_200_000_or_more,
Male_Total,	Female_Total */
------------------------------------------------------------------------------------------------------------------------
select top (10) * from nyc_final1;
------------------------------------------------------------------------------------------------------------------------
----------------------------------Grouping data as per ZIPCODE----------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
select zipcode, sum(White)	White	,sum(African)	African	,sum(American_Indian)	American_Indian	,sum(Asian)	Asian	,
sum(Hawaiian)	Hawaiian	,sum(Other_race)	Other_race	,sum(INCOME_Less_than_10_000)	INCOME_Less_than_10_000	,
sum(INCOME_10_000_to_14_999)	INCOME_10_000_to_14_999	,sum(INCOME_15_000_to_19_999)	INCOME_15_000_to_19_999	,
sum(INCOME_20_000_to_24_999)	INCOME_20_000_to_24_999	,sum(INCOME_25_000_to_29_999)	INCOME_25_000_to_29_999	,
sum(INCOME_30_000_to_34_999)	INCOME_30_000_to_34_999	,sum(INCOME_35_000_to_39_999)	INCOME_35_000_to_39_999	,
sum(INCOME_40_000_to_44_999)	INCOME_40_000_to_44_999	,sum(INCOME_45_000_to_49_999)	INCOME_45_000_to_49_999	,
sum(INCOME_50_000_to_59_999)	INCOME_50_000_to_59_999	,sum(INCOME_60_000_to_74_999)	INCOME_60_000_to_74_999	,
sum(INCOME_75_000_to_99_999)	INCOME_75_000_to_99_999	,sum(INCOME_100_000_to_124_999)	INCOME_100_000_to_124_999	,
sum(INCOME_125_000_to_149_999)	INCOME_125_000_to_149_999	,sum(INCOME_150_000_to_199_999)	INCOME_150_000_to_199_999	,
sum(INCOME_200_000_or_more)	INCOME_200_000_or_more
from nyc_final1 group by zipcode 
;
------------------------------------------------------------------------------------------------------------------------
-------------------------Understanding Household income and potential---------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
select zipcode, sum(White)	White	,sum(African)	African	,sum(American_Indian)	American_Indian	,sum(Asian)	Asian	,
sum(Hawaiian)	Hawaiian	,sum(Other_race)	Other_race	,sum(INCOME_Less_than_10_000)	INCOME_Less_than_10_000	,
sum(INCOME_10_000_to_14_999)	INCOME_10_000_to_14_999	,sum(INCOME_15_000_to_19_999)	INCOME_15_000_to_19_999	,
sum(INCOME_20_000_to_24_999)	INCOME_20_000_to_24_999	,sum(INCOME_25_000_to_29_999)	INCOME_25_000_to_29_999	,
sum(INCOME_30_000_to_34_999)	INCOME_30_000_to_34_999	,sum(INCOME_35_000_to_39_999)	INCOME_35_000_to_39_999	,
sum(INCOME_40_000_to_44_999)	INCOME_40_000_to_44_999	,sum(INCOME_45_000_to_49_999)	INCOME_45_000_to_49_999	,
sum(INCOME_50_000_to_59_999)	INCOME_50_000_to_59_999	,sum(INCOME_60_000_to_74_999)	INCOME_60_000_to_74_999	,
sum(INCOME_75_000_to_99_999)	INCOME_75_000_to_99_999	,sum(INCOME_100_000_to_124_999)	INCOME_100_000_to_124_999	,
sum(INCOME_125_000_to_149_999)	INCOME_125_000_to_149_999	,sum(INCOME_150_000_to_199_999)	INCOME_150_000_to_199_999	,
sum(INCOME_200_000_or_more)	INCOME_200_000_or_more
from nyc_final1 where zipcode in (
    11357, 11109, 11694, 10111, 10271, 10118, 10103, 10158, 10080, 10165)
group by zipcode 
;
------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------END----------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------